<!DOCTYPE html>
<html lang="zh-CN">

<head>
    <meta charset="UTF-8">
    <title>Document</title>
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="viewport" content="width=device-width, initial-scale=1, minimal-ui,user-scalable=0">
    <meta name="format-detection" content="telephone=no" />
    <link rel="stylesheet" href="../css/main.css">
    <script>
    window.PointerEvent = undefined
    </script>
</head>

<body>
    <div class="container">
        <section class="benefitsBox scrollBox">
            <div>
                <div class="userItem">
                    <!-- <div class="avar">
                            <img src="../images/img4.png">
                        </div> -->
                    <div class="avarInfo">
                        <div class="avarName">
                            <span class="aname">风扇风扇</span>
                            <!-- <span class="level"><img src="../images/icon-vip.png" alt=""></span> -->
                            <span class="integral">积分<em>20000</em></span>
                            <span class="ub">U币<em>2000</em></span>
                        </div>
                    </div>
                    <div class="group">
                        <span class="iconfontYZ iconYZ-gouwuche"></span>
                    </div>
                </div>
                <div class="trolleyBox">
                    <div class="trolleyLst">
                        <div class="item">
                            <label class="frIpt">
                                <input type="checkbox" class="mgc" />
                            </label>
                            <div class="shopAvar">
                                <img src="../images/img10.jpg">
                            </div>
                            <div class="gameId">
                                <div class="name">大皇帝 银卡1</div>
                                <div class="price"><span class="priceNum">72</span> U币 x
                                    <span class="pcs">1</span>
                                </div>
                            </div>
                            <p class="shopDel"><i class="iconfontYZ iconYZ-shanchu"></i></p>
                        </div>
                        <div class="item">
                            <label class="frIpt">
                                <input type="checkbox" class="mgc" />
                            </label>
                            <div class="shopAvar">
                                <img src="../images/img10.jpg">
                            </div>
                            <div class="gameId">
                                <div class="name">大皇帝 银卡2</div>
                                <div class="price"><span class="priceNum">95</span> U币 x
                                    <span class="pcs">5</span>
                                </div>
                            </div>
                            <p class="shopDel"><i class="iconfontYZ iconYZ-shanchu"></i></p>
                        </div>
                        <div class="item">
                            <label class="frIpt">
                                <input type="checkbox" class="mgc" />
                            </label>
                            <div class="shopAvar">
                                <img src="../images/img10.jpg">
                            </div>
                            <div class="gameId">
                                <div class="name">大皇帝 银卡3</div>
                                <div class="price"><span class="priceNum">150</span> U币 x
                                    <span class="pcs">1</span>
                                </div>
                            </div>
                            <p class="shopDel"><i class="iconfontYZ iconYZ-shanchu"></i></p>
                        </div>
                        <div class="item">
                            <label class="frIpt">
                                <input type="checkbox" class="mgc" />
                            </label>
                            <div class="shopAvar">
                                <img src="../images/img10.jpg">
                            </div>
                            <div class="gameId">
                                <div class="name">大皇帝 银卡4</div>
                                <div class="price"><span class="priceNum">72</span> U币 x
                                    <span class="pcs">1</span>
                                </div>
                            </div>
                            <p class="shopDel"><i class="iconfontYZ iconYZ-shanchu"></i></p>
                        </div>
                        <div class="item">
                            <label class="frIpt">
                                <input type="checkbox" class="mgc" />
                            </label>
                            <div class="shopAvar">
                                <img src="../images/img10.jpg">
                            </div>
                            <div class="gameId">
                                <div class="name">大皇帝 银卡5</div>
                                <div class="price"><span class="priceNum">72</span> U币 x
                                    <span class="pcs">5</span></div>
                            </div>
                            <p class="shopDel"><i class="iconfontYZ iconYZ-shanchu"></i></p>
                        </div>
                    </div>
                    <!-- // -->
                </div>
            </div>
            <div class="totalBox">
                <label for="" class="frIpt">
                    <input type="checkbox" name="" id="checkAll" class="mgc">　全选
                </label>
                <a href="javascript:popup(1);" class="btn_exchange f-fr">结算(<span class="shopNum">0</span>)</a>
                <div class="totalNum f-fr">合计：<span class="total">0</span> U币</div>
            </div>
        </section>
    </div>
    <div class="mask"></div>
</body>
<script src="../js/jquery.min.js"></script>
<script src="../js/iscroll.js"></script>
<script src="../js/main.js"></script>
<script>
$(function() {
    Community.isscrollFunc(".scrollBox");
    var item = $(".trolleyLst").find(".item"),
        checks = $(".trolleyLst").find(".mgc:checkbox");
    item.each(function(i, el) {
        //是否选中
        $(el).find(checks).on('click', function() {
            var n = 0,
                num = 0,
                s = 0;
            item.each(function(i, el1) {
                if (checks[i].checked) {
                    n++;
                    num += parseInt($(this).find(".pcs").text());
                    s += parseInt($(this).find(".pcs").text()) * parseInt($(this).find(".priceNum").text())
                }
            })
            if (n == item.length) {
                $("#checkAll:checkbox").prop("checked", true);
            } else {
                $("#checkAll:checkbox").prop("checked", false);
            }
            $(".total").html(s);
            $(".shopNum").html(num);
        });

        //删除
        $(el).find(".shopDel").on('click', function() {
            if (checks[i].checked) {
                return;
            } else {
                $(el).remove();
            }
        });
    })

    //全选
    $("#checkAll").click(function() {
        if (this.checked) {
            $(".trolleyLst :checkbox").prop("checked", true);
            setTotal();
        } else {
            $(".trolleyLst :checkbox").prop("checked", false);
            $(".total").html(0);
            $(".shopNum").html(0)
        }
    });
    // 总计
    function setTotal() {
        var s = 0,
            num = 0;
        item.each(function() {
            s += parseInt($(this).find('.priceNum').text()) * parseInt($(this).find('.pcs').text());
            num += parseInt($(this).find('.pcs').text());
        });
        $(".total").html(s);
        $(".shopNum").html(num);
    }


})
</script>