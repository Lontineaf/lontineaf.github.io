<!DOCTYPE html>
<html lang="zh-CN">

<head>
    <meta charset="UTF-8">
    <title>Document</title>
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="viewport" content="width=device-width, initial-scale=1, minimal-ui,user-scalable=0">
    <link rel="stylesheet" href="css/main.css">
</head>

<body>
    <div class="container">
        <input type="file" class="aa">
        <div class="uploadAvarBox">
            <canvas width="100%" height="100%" id="canvas" style="background: #000"></canvas>
            <div class="uaBtn">
                <span class="cancelBtn">取消</span>
                <span class="okBtn">确定</span>
            </div>
        </div>
    </div>
</body>
<script src="js/jquery.min.js"></script>
<script src="js/hammer.js"></script>
<script src="js/main.js"></script>
<script>
$(function() {


    $(document).on('change', 'input[type=file]', function(e) {
        var fileReader = new FileReader();
        fileReader.readAsDataURL(this.files[0]);
        fileReader.onload = function(e) {
            $(".aa").hide();
            var img = new Image();
            img.src = this.result;
            img.onload = function(argument) {
                $(".uploadAvarBox").show()
                Community.uploadAvar(img.src);
            }
        };
    });

    function Searchgrid() {
        //清除画布
        var c = document.getElementById("canvas");
        c.remove(); //用于清除canvas  重要
        //添加canvas
        $(".uaBtn").before("<canvas id=\"canvas\" width=\"100\" height=\"100\" style=\"background: #000\"></canvas>");

    }

    window.addEventListener("onorientationchange" in window ? "orientationchange" : "resize", function() {

        Searchgrid()

        $(".uploadAvarBox").hide();
        $(".aa").val('').show();
    }, false);
})
</script>

</html>